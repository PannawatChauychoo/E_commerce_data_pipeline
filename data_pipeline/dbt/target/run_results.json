{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-08T18:32:22.448747Z", "invocation_id": "fb346315-4566-4ce2-9bcd-b2332e8afce9", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:14.406998Z", "completed_at": "2025-05-08T18:32:14.421247Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:14.421799Z", "completed_at": "2025-05-08T18:32:14.421806Z"}], "thread_id": "main", "execution_time": 0.014808, "adapter_response": {}, "message": "dbt_walmart.on-run-start.0 passed", "failures": 0, "unique_id": "operation.dbt_walmart.dbt_walmart-on-run-start-0", "compiled": true, "compiled_code": "", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:14.428847Z", "completed_at": "2025-05-08T18:32:14.713815Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:14.714346Z", "completed_at": "2025-05-08T18:32:14.958704Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5311679840087891, "adapter_response": {"_message": "SELECT 858", "code": "SELECT", "rows_affected": 858}, "message": "SELECT 858", "failures": null, "unique_id": "model.dbt_walmart.dim_date", "compiled": true, "compiled_code": "\n\nWITH calendar AS (\n  SELECT * FROM (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 858\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('01/01/2023' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= current_date\n\n)\n\nselect * from filtered\n\n\n  ) AS date_spine\n)\n\n\nSELECT\n  date_day                                   AS real_date,          -- 2025\u201105\u201104\n  TO_CHAR(date_day, 'YYYYMMDD')::int         AS date_key,\n  EXTRACT(YEAR  FROM date_day)::int          AS year,\n  EXTRACT(MONTH FROM date_day)::int          AS month,\n  EXTRACT(DAY   FROM date_day)::int          AS day,\n  TO_CHAR(date_day, 'Day')                   AS weekday_name   \n\nFROM calendar", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"dim_date\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:14.964240Z", "completed_at": "2025-05-08T18:32:14.967099Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:14.967384Z", "completed_at": "2025-05-08T18:32:15.309469Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3464548587799072, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_walmart.stg_cust1", "compiled": true, "compiled_code": "\n\nSELECT \nunique_id as customer_id, segment_id,\nage, gender, city_category, stay_in_current_city_years, marital_status, \nvisit_prob, created_at AS signup_date, updated_at AS last_purchase_date\nFROM \"ecommerce_cloud\".\"walmart\".\"cust1_demographics\"\nWHERE unique_id IS NOT NULL", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"stg_cust1\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:15.312182Z", "completed_at": "2025-05-08T18:32:15.314644Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:15.314876Z", "completed_at": "2025-05-08T18:32:15.658277Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.347247838973999, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_walmart.stg_cust2", "compiled": true, "compiled_code": "\n\nSELECT\nunique_id AS customer_id, segment_id,\nbranch, city, customer_type, gender, payment_method,\ncreated_at AS signup_date, updated_at AS last_purchase_date\nFROM \"ecommerce_cloud\".\"walmart\".\"cust2_demographics\"\nWHERE unique_id IS NOT NULL", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"stg_cust2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:15.662290Z", "completed_at": "2025-05-08T18:32:15.665740Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:15.666063Z", "completed_at": "2025-05-08T18:32:16.008331Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.34772205352783203, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_walmart.stg_customers_lookup", "compiled": true, "compiled_code": "\n\nSELECT\ncustomer_id, external_id, cust_type, segment_id\nFROM \"ecommerce_cloud\".\"walmart\".\"customers_lookup\"\nWHERE external_id IS NOT NULL AND cust_type IS NOT NULL", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"stg_customers_lookup\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:16.014185Z", "completed_at": "2025-05-08T18:32:16.019965Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:16.020321Z", "completed_at": "2025-05-08T18:32:16.390976Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3783700466156006, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_walmart.stg_products", "compiled": true, "compiled_code": "\n\nSELECT \nproduct_id, category, unit_price, stock, \nlead_days, ordering_cost, holding_cost_per_unit,\nEOQ, created_at, updated_at\nFROM \"ecommerce_cloud\".\"walmart\".\"products\"\nWHERE product_id IS NOT NULL", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"stg_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:16.394191Z", "completed_at": "2025-05-08T18:32:16.397119Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:16.397351Z", "completed_at": "2025-05-08T18:32:16.774476Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3815879821777344, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_walmart.stg_transactions", "compiled": true, "compiled_code": "\n\nSELECT\n    transaction_id,\n    unique_id AS customer_id,\n    product_id,\n    unit_price,\n    quantity,\n    date_purchased,\n    category,\n    unit_price * quantity AS total_amount,\n    created_at\nFROM \"ecommerce_cloud\".\"walmart\".\"transactions\"\nWHERE transaction_id IS NOT NULL", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"stg_transactions\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:16.778719Z", "completed_at": "2025-05-08T18:32:17.058182Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:17.058627Z", "completed_at": "2025-05-08T18:32:17.100728Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.343656063079834, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_walmart.dbt_expectations_expect_column_values_to_be_in_type_list_dim_date_date_day__date__datetime.2ccb58028d", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('REAL_DATE' as TEXT) as relation_column,\n            cast('TIMESTAMP WITHOUT TIME ZONE' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('DATE_KEY' as TEXT) as relation_column,\n            cast('INTEGER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('YEAR' as TEXT) as relation_column,\n            cast('INTEGER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('MONTH' as TEXT) as relation_column,\n            cast('INTEGER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('DAY' as TEXT) as relation_column,\n            cast('INTEGER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('WEEKDAY_NAME' as TEXT) as relation_column,\n            cast('TEXT' as TEXT) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'DATE_DAY'\n            and\n            relation_column_type not in ('DATE', 'DATETIME')\n\n    )\n    select *\n    from test_data", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:17.124542Z", "completed_at": "2025-05-08T18:32:17.129307Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:17.129613Z", "completed_at": "2025-05-08T18:32:17.473217Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3506510257720947, "adapter_response": {"_message": "SELECT 500", "code": "SELECT", "rows_affected": 500}, "message": "SELECT 500", "failures": null, "unique_id": "model.dbt_walmart.dim_customers", "compiled": true, "compiled_code": "\n\n\nselect customer_id, segment_id, signup_date, last_purchase_date\nfrom \"ecommerce_cloud\".\"dev_walmart\".\"stg_cust1\"\n\nUNION ALL\n\nselect customer_id, segment_id, signup_date, last_purchase_date\nfrom \"ecommerce_cloud\".\"dev_walmart\".\"stg_cust2\"", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"dim_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:17.478392Z", "completed_at": "2025-05-08T18:32:17.483601Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:17.484036Z", "completed_at": "2025-05-08T18:32:17.854592Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.37794995307922363, "adapter_response": {"_message": "SELECT 250", "code": "SELECT", "rows_affected": 250}, "message": "SELECT 250", "failures": null, "unique_id": "model.dbt_walmart.dim_cust1_ext", "compiled": true, "compiled_code": "\n\nSELECT\nl.customer_id, c.segment_id, c.visit_prob,\nc.age, c.gender, c.city_category, c.stay_in_current_city_years, c.marital_status, \nc.signup_date, c.last_purchase_date\nFROM \"ecommerce_cloud\".\"dev_walmart\".\"stg_cust1\" AS c JOIN \"ecommerce_cloud\".\"dev_walmart\".\"stg_customers_lookup\" AS l\nON c.customer_id = l.external_id\nWHERE l.cust_type = 'Cust1'", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"dim_cust1_ext\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:17.858715Z", "completed_at": "2025-05-08T18:32:17.862158Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:17.862495Z", "completed_at": "2025-05-08T18:32:18.199321Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3422510623931885, "adapter_response": {"_message": "SELECT 250", "code": "SELECT", "rows_affected": 250}, "message": "SELECT 250", "failures": null, "unique_id": "model.dbt_walmart.dim_cust2_ext", "compiled": true, "compiled_code": "\n\nSELECT\nl.customer_id, c.segment_id,\nbranch, city, customer_type, gender, payment_method,\nc.signup_date, c.last_purchase_date\nFROM \"ecommerce_cloud\".\"dev_walmart\".\"stg_cust2\" AS c JOIN \"ecommerce_cloud\".\"dev_walmart\".\"stg_customers_lookup\" AS l\nON c.customer_id = l.external_id\nWHERE l.cust_type = 'Cust2'", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"dim_cust2_ext\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:18.204056Z", "completed_at": "2025-05-08T18:32:18.210099Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:18.210542Z", "completed_at": "2025-05-08T18:32:18.551232Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3484761714935303, "adapter_response": {"_message": "SELECT 340", "code": "SELECT", "rows_affected": 340}, "message": "SELECT 340", "failures": null, "unique_id": "model.dbt_walmart.dim_products", "compiled": true, "compiled_code": "\n\nSELECT\nproduct_id, category, unit_price, stock, \nlead_days, ordering_cost, holding_cost_per_unit,\nEOQ, created_at, updated_at\nFROM \"ecommerce_cloud\".\"dev_walmart\".\"stg_products\"", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"dim_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:18.555158Z", "completed_at": "2025-05-08T18:32:18.563932Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:18.564207Z", "completed_at": "2025-05-08T18:32:19.079847Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5258541107177734, "adapter_response": {"_message": "SELECT 36322", "code": "SELECT", "rows_affected": 36322}, "message": "SELECT 36322", "failures": null, "unique_id": "model.dbt_walmart.fct_order", "compiled": true, "compiled_code": "\n\nwith source_data as (\n\n  select\n    /* your source columns, renamed to match your fact */\n    to_char(date_purchased, 'YYYYMMDD')::int  AS date_key,\n    t.customer_id,\n    dl.segment_id,                                 \n    t.product_id,\n    t.transaction_id,\n    t.quantity,\n    t.total_amount\n  from \"ecommerce_cloud\".\"dev_walmart\".\"stg_transactions\" t\n  JOIN \"ecommerce_cloud\".\"dev_walmart\".\"dim_customers\" dl ON t.customer_id = dl.customer_id\n\n)\n\nselect * from source_data\n\n", "relation_name": "\"ecommerce_cloud\".\"dev_walmart\".\"fct_order\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:19.082411Z", "completed_at": "2025-05-08T18:32:19.087001Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:19.087237Z", "completed_at": "2025-05-08T18:32:19.323593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.28488779067993164, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_walmart.not_null_dim_products_product_id.c8aba288d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"ecommerce_cloud\".\"dev_walmart\".\"dim_products\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:19.371061Z", "completed_at": "2025-05-08T18:32:19.378958Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:19.379355Z", "completed_at": "2025-05-08T18:32:19.606511Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.26483702659606934, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_walmart.unique_dim_products_product_id.ef7b2a9985", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_cloud\".\"dev_walmart\".\"dim_products\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:19.640847Z", "completed_at": "2025-05-08T18:32:19.648098Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:19.648408Z", "completed_at": "2025-05-08T18:32:19.892963Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.27243709564208984, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_walmart.not_null_fct_order_total_amount.abc9ab534a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount\nfrom \"ecommerce_cloud\".\"dev_walmart\".\"fct_order\"\nwhere total_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:19.916124Z", "completed_at": "2025-05-08T18:32:19.922343Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:19.922758Z", "completed_at": "2025-05-08T18:32:20.161539Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.27009010314941406, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_walmart.not_null_fct_order_transaction_id.fddd99ce58", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom \"ecommerce_cloud\".\"dev_walmart\".\"fct_order\"\nwhere transaction_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:20.190489Z", "completed_at": "2025-05-08T18:32:20.196216Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:20.196558Z", "completed_at": "2025-05-08T18:32:20.522075Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.35819387435913086, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_walmart.unique_fct_order_transaction_id.cf49037d7c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom \"ecommerce_cloud\".\"dev_walmart\".\"fct_order\"\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:20.551090Z", "completed_at": "2025-05-08T18:32:20.555361Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:20.555748Z", "completed_at": "2025-05-08T18:32:20.994049Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4447202682495117, "adapter_response": {"_message": "SELECT 34", "code": "SELECT", "rows_affected": 34}, "message": "SELECT 34", "failures": null, "unique_id": "model.dbt_walmart.kpi_avg_cat_orders", "compiled": true, "compiled_code": "\n\n\nSELECT\n    category,\n    SUM(total_amount) AS total_spent,\n    COUNT(DISTINCT ft.transaction_id) AS total_orders,\n    AVG(total_amount) AS avg_order_value\nFROM \"ecommerce_cloud\".\"dev_walmart\".\"fct_order\" ft JOIN \"ecommerce_cloud\".\"dev_walmart\".\"dim_products\" p \nON ft.product_id = p.product_id\nGROUP BY category", "relation_name": "\"ecommerce_cloud\".\"dev_walmart_analytics\".\"kpi_avg_cat_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:20.998900Z", "completed_at": "2025-05-08T18:32:21.004108Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:21.004486Z", "completed_at": "2025-05-08T18:32:21.398456Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4011361598968506, "adapter_response": {"_message": "SELECT 499", "code": "SELECT", "rows_affected": 499}, "message": "SELECT 499", "failures": null, "unique_id": "model.dbt_walmart.kpi_clv", "compiled": true, "compiled_code": "\n\nWITH customer_clv AS (\n    SELECT \n    customer_id,\n    SUM(total_amount) as total_amount,\n    COUNT(DISTINCT transaction_id) AS total_orders,\n    MIN(d.real_date) as first_purchase_date,\n    MAX(d.real_date) as last_purchase_date\n\n    FROM \"ecommerce_cloud\".\"dev_walmart\".\"fct_order\" ft JOIN \"ecommerce_cloud\".\"dev_walmart\".\"dim_date\" d ON ft.date_key = d.date_key\n    GROUP BY customer_id\n)\n\nSELECT\ncustomer_id,\ntotal_amount,\ntotal_orders,\nEXTRACT(DAY FROM AGE(last_purchase_date, first_purchase_date)) AS lifetime_days\nFROM customer_clv", "relation_name": "\"ecommerce_cloud\".\"dev_walmart_analytics\".\"kpi_clv\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:21.402747Z", "completed_at": "2025-05-08T18:32:21.408449Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:21.408837Z", "completed_at": "2025-05-08T18:32:21.789186Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.38800525665283203, "adapter_response": {"_message": "SELECT 858", "code": "SELECT", "rows_affected": 858}, "message": "SELECT 858", "failures": null, "unique_id": "model.dbt_walmart.kpi_purchase_frequency", "compiled": true, "compiled_code": "\n\nWITH last_30_days AS (\n\n  -- pick the calendar dates you want (using your dim_date model)\n  SELECT\n    date_key,\n    real_date AS order_date\n  FROM \"ecommerce_cloud\".\"dev_walmart\".\"dim_date\"\n)\n\nSELECT\n  d.order_date,\n  COALESCE(COUNT(o.transaction_id), 0) AS order_count\n\nFROM last_30_days d LEFT JOIN \"ecommerce_cloud\".\"dev_walmart\".\"fct_order\" o\nON o.date_key = d.date_key     -- join via the integer surrogate key\n\nGROUP BY d.order_date\nORDER BY d.order_date", "relation_name": "\"ecommerce_cloud\".\"dev_walmart_analytics\".\"kpi_purchase_frequency\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-08T18:32:21.793819Z", "completed_at": "2025-05-08T18:32:21.798809Z"}, {"name": "execute", "started_at": "2025-05-08T18:32:21.799158Z", "completed_at": "2025-05-08T18:32:22.198285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4062521457672119, "adapter_response": {"_message": "SELECT 15", "code": "SELECT", "rows_affected": 15}, "message": "SELECT 15", "failures": null, "unique_id": "model.dbt_walmart.kpi_segment_value", "compiled": true, "compiled_code": "-- Calculate lifetime total value for each segment: Sum of purchases for each segment\n\n\n\nSELECT\n    segment_id,\n    SUM(total_amount) AS total_spent,\n    COUNT(DISTINCT transaction_id) AS total_orders,\n    RANK () OVER (ORDER BY SUM(total_amount) DESC) AS rank\nFROM \"ecommerce_cloud\".\"dev_walmart\".\"fct_order\"\nGROUP BY segment_id\nORDER BY rank", "relation_name": "\"ecommerce_cloud\".\"dev_walmart_analytics\".\"kpi_segment_value\"", "batch_results": null}], "elapsed_time": 9.39795994758606, "args": {"log_file_max_bytes": 10485760, "require_yaml_configuration_for_mf_time_spines": false, "skip_nodes_if_on_run_start_fails": false, "populate_cache": true, "static_parser": true, "empty": false, "defer": false, "log_format": "default", "log_format_file": "debug", "state_modified_compare_more_unrendered_values": false, "log_level": "info", "project_dir": "/Users/macos/Personal_projects/Portfolio/Project_1_Walmart/Walmart_sim/backend/dbt_walmart", "invocation_command": "dbt build --full-refresh --target dev", "cache_selected_only": false, "state_modified_compare_vars": false, "show_resource_report": false, "strict_mode": false, "full_refresh": true, "use_colors": true, "include_saved_query": false, "favor_state": false, "version_check": true, "target": "dev", "partial_parse_file_diff": true, "resource_types": [], "export_saved_queries": false, "macro_debugging": false, "quiet": false, "introspect": true, "exclude": [], "show": false, "exclude_resource_types": [], "source_freshness_run_project_hooks": false, "vars": {}, "profiles_dir": "/Users/macos/Personal_projects/Portfolio/Project_1_Walmart/Walmart_sim/backend/dbt_walmart", "require_batched_execution_for_custom_microbatch_strategy": false, "require_resource_names_without_spaces": false, "select": [], "send_anonymous_usage_stats": true, "log_path": "/Users/macos/Personal_projects/Portfolio/Project_1_Walmart/Walmart_sim/backend/dbt_walmart/logs", "print": true, "log_level_file": "debug", "require_nested_cumulative_type_params": false, "which": "build", "printer_width": 80, "indirect_selection": "eager", "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "warn_error_options": {"include": [], "exclude": []}, "use_colors_file": true, "partial_parse": true}}